function url(e){return"undefined"==typeof e&&(e=""),-1!==e.indexOf("http")?e:host+e}function redirect(e){window.location=url(e)}function componentToHex(e){var r=e.toString(16);return 1==r.length?"0"+r:r}function rgbToHex(e,r,t){return"#"+componentToHex(e)+componentToHex(r)+componentToHex(t)}function LongPress(e,r){this.length_=r;var t=this;t.map_=e,t.timeoutId_=null,google.maps.event.addListener(e,"mousedown",function(e){t.onMouseDown_(e)}),google.maps.event.addListener(e,"mouseup",function(e){t.onMouseUp_(e)}),google.maps.event.addListener(e,"drag",function(e){t.onMapDrag_(e)})}function MarkerClusterer(e,r,t){this.extend(MarkerClusterer,google.maps.OverlayView),this.map_=e,this.markers_=[],this.clusters_=[],this.sizes=[53,56,66,78,90],this.styles_=[],this.ready_=!1;var o=t||{};this.gridSize_=o.gridSize||60,this.minClusterSize_=o.minimumClusterSize||2,this.maxZoom_=o.maxZoom||null,this.styles_=o.styles||[],this.imagePath_=o.imagePath||this.MARKER_CLUSTER_IMAGE_PATH_,this.imageExtension_=o.imageExtension||this.MARKER_CLUSTER_IMAGE_EXTENSION_,this.zoomOnClick_=!0,void 0!=o.zoomOnClick&&(this.zoomOnClick_=o.zoomOnClick),this.averageCenter_=!1,void 0!=o.averageCenter&&(this.averageCenter_=o.averageCenter),this.setupStyles_(),this.setMap(e),this.prevZoom_=this.map_.getZoom();var n=this;google.maps.event.addListener(this.map_,"zoom_changed",function(){var e=n.map_.getZoom();n.prevZoom_!=e&&(n.prevZoom_=e,n.resetViewport())}),google.maps.event.addListener(this.map_,"idle",function(){n.redraw()}),r&&r.length&&this.addMarkers(r,!1)}function Cluster(e){this.markerClusterer_=e,this.map_=e.getMap(),this.gridSize_=e.getGridSize(),this.minClusterSize_=e.getMinClusterSize(),this.averageCenter_=e.isAverageCenter(),this.center_=null,this.markers_=[],this.bounds_=null,this.clusterIcon_=new ClusterIcon(this,e.getStyles(),e.getGridSize())}function ClusterIcon(e,r,t){e.getMarkerClusterer().extend(ClusterIcon,google.maps.OverlayView),this.styles_=r,this.padding_=t||0,this.cluster_=e,this.center_=null,this.map_=e.getMap(),this.div_=null,this.sums_=null,this.visible_=!1,this.setMap(this.map_)}function initMenu(){$("#menu ul:not(.default-open)").hide(),$("#menu ul").children(".current").parent().show(),$("#menu li a").click(function(){var e=$(this).next();return e.is("ul")&&e.is(":visible")?!1:e.is("ul")&&!e.is(":visible")?($("#menu ul:visible").slideUp("normal"),e.slideDown("normal"),!1):void 0})}function googleLogin(e){angular.element("[ng-controller]").scope().events.googleLogin(e)}LongPress.prototype.onMouseUp_=function(e){clearTimeout(this.timeoutId_)},LongPress.prototype.onMouseDown_=function(e){clearTimeout(this.timeoutId_);var r=this.map_,t=e;this.timeoutId_=setTimeout(function(){google.maps.event.trigger(r,"longpress",t)},this.length_)},LongPress.prototype.onMapDrag_=function(e){clearTimeout(this.timeoutId_)},google.maps.Map.prototype.clearMarkers=function(e){for(var r=0;r<e.length;r++)e[r].circle&&e[r].circle.setMap(null),e[r].setMap(null)};var app=angular.module("app",[]),isMobile=!1;(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)))&&(isMobile=!0),app.config(["$httpProvider",function(e){e.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",e.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",e.defaults.transformRequest.unshift(function(e,r){var t,o=[];if("string"==typeof e)return e;for(t in e)e.hasOwnProperty(t)&&o.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return o.join("&")})}]),app.filter("reverse",function(){return function(e){return e.slice().reverse()}});var CanvasImage=function(e){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),document.body.appendChild(this.canvas),this.width=this.canvas.width=e.width,this.height=this.canvas.height=e.height,this.context.drawImage(e,0,0,this.width,this.height)};CanvasImage.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},CanvasImage.prototype.update=function(e){this.context.putImageData(e,0,0)},CanvasImage.prototype.getPixelCount=function(){return this.width*this.height},CanvasImage.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)},CanvasImage.prototype.removeCanvas=function(){this.canvas.parentNode.removeChild(this.canvas)};var ColorThief=function(){};if(ColorThief.prototype.getColor=function(e,r){var t=this.getPalette(e,5,r),o=t[0];return o},ColorThief.prototype.getPalette=function(e,r,t){"undefined"==typeof r&&(r=10),("undefined"==typeof t||1>t)&&(t=10);for(var o,n,a,i,s,u=new CanvasImage(e),c=u.getImageData(),l=c.data,p=u.getPixelCount(),d=[],h=0;p>h;h+=t)o=4*h,n=l[o+0],a=l[o+1],i=l[o+2],s=l[o+3],s>=125&&(n>250&&a>250&&i>250||d.push([n,a,i]));var f=MMCQ.quantize(d,r),m=f?f.palette():null;return u.removeCanvas(),m},!pv)var pv={map:function(e,r){var t={};return r?e.map(function(e,o){return t.index=o,r.call(t,e)}):e.slice()},naturalOrder:function(e,r){return r>e?-1:e>r?1:0},sum:function(e,r){var t={};return e.reduce(r?function(e,o,n){return t.index=n,e+r.call(t,o)}:function(e,r){return e+r},0)},max:function(e,r){return Math.max.apply(null,r?pv.map(e,r):e)}};var MMCQ=function(){function e(e,r,t){return(e<<2*u)+(r<<u)+t}function r(e){function r(){t.sort(e),o=!0}var t=[],o=!1;return{push:function(e){t.push(e),o=!1},peek:function(e){return o||r(),void 0===e&&(e=t.length-1),t[e]},pop:function(){return o||r(),t.pop()},size:function(){return t.length},map:function(e){return t.map(e)},debug:function(){return o||r(),t}}}function t(e,r,t,o,n,a,i){var s=this;s.r1=e,s.r2=r,s.g1=t,s.g2=o,s.b1=n,s.b2=a,s.histo=i}function o(){this.vboxes=new r(function(e,r){return pv.naturalOrder(e.vbox.count()*e.vbox.volume(),r.vbox.count()*r.vbox.volume())})}function n(r){var t,o,n,a,i=1<<3*u,s=new Array(i);return r.forEach(function(r){o=r[0]>>c,n=r[1]>>c,a=r[2]>>c,t=e(o,n,a),s[t]=(s[t]||0)+1}),s}function a(e,r){var o,n,a,i=1e6,s=0,u=1e6,l=0,p=1e6,d=0;return e.forEach(function(e){o=e[0]>>c,n=e[1]>>c,a=e[2]>>c,i>o?i=o:o>s&&(s=o),u>n?u=n:n>l&&(l=n),p>a?p=a:a>d&&(d=a)}),new t(i,s,u,l,p,d,r)}function i(r,t){function o(e){var r,o,n,a,i,s=e+"1",c=e+"2",l=0;for(u=t[s];u<=t[c];u++)if(f[u]>h/2){for(n=t.copy(),a=t.copy(),r=u-t[s],o=t[c]-u,i=o>=r?Math.min(t[c]-1,~~(u+o/2)):Math.max(t[s],~~(u-1-r/2));!f[i];)i++;for(l=m[i];!l&&f[i-1];)l=m[--i];return n[c]=i,a[s]=n[c]+1,[n,a]}}if(t.count()){var n=t.r2-t.r1+1,a=t.g2-t.g1+1,i=t.b2-t.b1+1,s=pv.max([n,a,i]);if(1==t.count())return[t.copy()];var u,c,l,p,d,h=0,f=[],m=[];if(s==n)for(u=t.r1;u<=t.r2;u++){for(p=0,c=t.g1;c<=t.g2;c++)for(l=t.b1;l<=t.b2;l++)d=e(u,c,l),p+=r[d]||0;h+=p,f[u]=h}else if(s==a)for(u=t.g1;u<=t.g2;u++){for(p=0,c=t.r1;c<=t.r2;c++)for(l=t.b1;l<=t.b2;l++)d=e(c,u,l),p+=r[d]||0;h+=p,f[u]=h}else for(u=t.b1;u<=t.b2;u++){for(p=0,c=t.r1;c<=t.r2;c++)for(l=t.g1;l<=t.g2;l++)d=e(c,l,u),p+=r[d]||0;h+=p,f[u]=h}return f.forEach(function(e,r){m[r]=h-e}),o(s==n?"r":s==a?"g":"b")}}function s(e,t){function s(e,r){for(var t,o=1,n=0;l>n;)if(t=e.pop(),t.count()){var a=i(u,t),s=a[0],c=a[1];if(!s)return;if(e.push(s),c&&(e.push(c),o++),o>=r)return;if(n++>l)return}else e.push(t),n++}if(!e.length||2>t||t>256)return!1;var u=n(e),c=0;u.forEach(function(){c++});var d=a(e,u),h=new r(function(e,r){return pv.naturalOrder(e.count(),r.count())});h.push(d),s(h,p*t);for(var f=new r(function(e,r){return pv.naturalOrder(e.count()*e.volume(),r.count()*r.volume())});h.size();)f.push(h.pop());s(f,t-f.size());for(var m=new o;f.size();)m.push(f.pop());return m}var u=5,c=8-u,l=1e3,p=.75;return t.prototype={volume:function(e){var r=this;return(!r._volume||e)&&(r._volume=(r.r2-r.r1+1)*(r.g2-r.g1+1)*(r.b2-r.b1+1)),r._volume},count:function(r){var t=this,o=t.histo;if(!t._count_set||r){var n,a,i,s=0;for(n=t.r1;n<=t.r2;n++)for(a=t.g1;a<=t.g2;a++)for(i=t.b1;i<=t.b2;i++)index=e(n,a,i),s+=o[index]||0;t._count=s,t._count_set=!0}return t._count},copy:function(){var e=this;return new t(e.r1,e.r2,e.g1,e.g2,e.b1,e.b2,e.histo)},avg:function(r){var t=this,o=t.histo;if(!t._avg||r){var n,a,i,s,c,l=0,p=1<<8-u,d=0,h=0,f=0;for(a=t.r1;a<=t.r2;a++)for(i=t.g1;i<=t.g2;i++)for(s=t.b1;s<=t.b2;s++)c=e(a,i,s),n=o[c]||0,l+=n,d+=n*(a+.5)*p,h+=n*(i+.5)*p,f+=n*(s+.5)*p;l?t._avg=[~~(d/l),~~(h/l),~~(f/l)]:t._avg=[~~(p*(t.r1+t.r2+1)/2),~~(p*(t.g1+t.g2+1)/2),~~(p*(t.b1+t.b2+1)/2)]}return t._avg},contains:function(e){var r=this,t=e[0]>>c;return gval=e[1]>>c,bval=e[2]>>c,t>=r.r1&&t<=r.r2&&gval>=r.g1&&gval<=r.g2&&bval>=r.b1&&bval<=r.b2}},o.prototype={push:function(e){this.vboxes.push({vbox:e,color:e.avg()})},palette:function(){return this.vboxes.map(function(e){return e.color})},size:function(){return this.vboxes.size()},map:function(e){for(var r=this.vboxes,t=0;t<r.size();t++)if(r.peek(t).vbox.contains(e))return r.peek(t).color;return this.nearest(e)},nearest:function(e){for(var r,t,o,n=this.vboxes,a=0;a<n.size();a++)t=Math.sqrt(Math.pow(e[0]-n.peek(a).color[0],2)+Math.pow(e[1]-n.peek(a).color[1],2)+Math.pow(e[2]-n.peek(a).color[2],2)),(r>t||void 0===r)&&(r=t,o=n.peek(a).color);return o},forcebw:function(){var e=this.vboxes;e.sort(function(e,r){return pv.naturalOrder(pv.sum(e.color),pv.sum(r.color))});var r=e[0].color;r[0]<5&&r[1]<5&&r[2]<5&&(e[0].color=[0,0,0]);var t=e.length-1,o=e[t].color;o[0]>251&&o[1]>251&&o[2]>251&&(e[t].color=[255,255,255])}},{quantize:s}}();!function(e,r){"object"==typeof exports?module.exports=r():"function"==typeof define&&define.amd?define(r):e.Hasher=r()}(this,function(){"use strict";var e=14,r=8,t=!1,o=function(e){try{return unescape(encodeURIComponent(e))}catch(r){throw"Error on UTF-8 encode"}},n=function(e){try{return decodeURIComponent(escape(e))}catch(r){throw"Bad Key"}},a=function(e){var r,t,o=[];for(16>e.length&&(r=16-e.length,o=[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r]),t=0;e.length>t;t++)o[t]=e[t];return o},i=function(e,r){var t,o,n="";if(r){if(t=e[15],t>16)throw"Decryption error: Maybe bad key";if(16===t)return"";for(o=0;16-t>o;o++)n+=String.fromCharCode(e[o])}else for(o=0;16>o;o++)n+=String.fromCharCode(e[o]);return n},s=function(e){var r,t="";for(r=0;e.length>r;r++)t+=(16>e[r]?"0":"")+e[r].toString(16);return t},u=function(e){var r=[];return e.replace(/(..)/g,function(e){r.push(parseInt(e,16))}),r},c=function(e,r){var t,n=[];for(r||(e=o(e)),t=0;e.length>t;t++)n[t]=e.charCodeAt(t);return n},l=function(t){switch(t){case 128:e=10,r=4;break;case 192:e=12,r=6;break;case 256:e=14,r=8;break;default:throw"Invalid Key Size Specified:"+t}},p=function(e){var r,t=[];for(r=0;e>r;r++)t=t.concat(Math.floor(256*Math.random()));return t},d=function(t,o){var n,a=e>=12?3:2,i=[],s=[],u=[],c=[],l=t.concat(o);for(u[0]=Z(l),c=u[0],n=1;a>n;n++)u[n]=Z(u[n-1].concat(l)),c=c.concat(u[n]);return i=c.slice(0,4*r),s=c.slice(4*r,4*r+16),{key:i,iv:s}},h=function(e,r,t){r=C(r);var o,n=Math.ceil(e.length/16),i=[],s=[];for(o=0;n>o;o++)i[o]=a(e.slice(16*o,16*o+16));for(0===e.length%16&&(i.push([16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16]),n++),o=0;i.length>o;o++)i[o]=0===o?_(i[o],t):_(i[o],s[o-1]),s[o]=m(i[o],r);return s},f=function(e,r,t,o){r=C(r);var a,s=e.length/16,u=[],c=[],l="";for(a=0;s>a;a++)u.push(e.slice(16*a,16*(a+1)));for(a=u.length-1;a>=0;a--)c[a]=g(u[a],r),c[a]=0===a?_(c[a],t):_(c[a],u[a-1]);for(a=0;s-1>a;a++)l+=i(c[a]);return l+=i(c[a],!0),o?l:n(l)},m=function(r,o){t=!1;var n,a=M(r,o,0);for(n=1;e+1>n;n++)a=k(a),a=v(a),e>n&&(a=y(a)),a=M(a,o,n);return a},g=function(r,o){t=!0;var n,a=M(r,o,e);for(n=e-1;n>-1;n--)a=v(a),a=k(a),a=M(a,o,n),n>0&&(a=y(a));return a},k=function(e){var r,o=t?I:T,n=[];for(r=0;16>r;r++)n[r]=o[e[r]];return n},v=function(e){var r,o=[],n=t?[0,13,10,7,4,1,14,11,8,5,2,15,12,9,6,3]:[0,5,10,15,4,9,14,3,8,13,2,7,12,1,6,11];for(r=0;16>r;r++)o[r]=e[n[r]];return o},y=function(e){var r,o=[];if(t)for(r=0;4>r;r++)o[4*r]=R[e[4*r]]^B[e[1+4*r]]^E[e[2+4*r]]^O[e[3+4*r]],o[1+4*r]=O[e[4*r]]^R[e[1+4*r]]^B[e[2+4*r]]^E[e[3+4*r]],o[2+4*r]=E[e[4*r]]^O[e[1+4*r]]^R[e[2+4*r]]^B[e[3+4*r]],o[3+4*r]=B[e[4*r]]^E[e[1+4*r]]^O[e[2+4*r]]^R[e[3+4*r]];else for(r=0;4>r;r++)o[4*r]=A[e[4*r]]^z[e[1+4*r]]^e[2+4*r]^e[3+4*r],o[1+4*r]=e[4*r]^A[e[1+4*r]]^z[e[2+4*r]]^e[3+4*r],o[2+4*r]=e[4*r]^e[1+4*r]^A[e[2+4*r]]^z[e[3+4*r]],o[3+4*r]=z[e[4*r]]^e[1+4*r]^e[2+4*r]^A[e[3+4*r]];return o},M=function(e,r,t){var o,n=[];for(o=0;16>o;o++)n[o]=e[o]^r[t][o];return n},_=function(e,r){var t,o=[];for(t=0;16>t;t++)o[t]=e[t]^r[t];return o},C=function(t){var o,n,a,i,s=[],u=[],c=[];for(o=0;r>o;o++)n=[t[4*o],t[4*o+1],t[4*o+2],t[4*o+3]],s[o]=n;for(o=r;4*(e+1)>o;o++){for(s[o]=[],a=0;4>a;a++)u[a]=s[o-1][a];for(0===o%r?(u=b(w(u)),u[0]^=P[o/r-1]):r>6&&4===o%r&&(u=b(u)),a=0;4>a;a++)s[o][a]=s[o-r][a]^u[a]}for(o=0;e+1>o;o++)for(c[o]=[],i=0;4>i;i++)c[o].push(s[4*o+i][0],s[4*o+i][1],s[4*o+i][2],s[4*o+i][3]);return c},b=function(e){for(var r=0;4>r;r++)e[r]=T[e[r]];return e},w=function(e){var r,t=e[0];for(r=0;4>r;r++)e[r]=e[r+1];return e[3]=t,e},x=function(e,r){var t,o=[];for(t=0;e.length>t;t+=r)o[t/r]=parseInt(e.substr(t,r),16);return o},S=function(e){var r,t=[];for(r=0;e.length>r;r++)t[e[r]]=r;return t},$=function(e,r){var t,o;for(o=0,t=0;8>t;t++)o=1===(1&r)?o^e:o,e=e>127?283^e<<1:e<<1,r>>>=1;return o},L=function(e){var r,t=[];for(r=0;256>r;r++)t[r]=$(e,r);return t},T=x("637c777bf26b6fc53001672bfed7ab76ca82c97dfa5947f0add4a2af9ca472c0b7fd9326363ff7cc34a5e5f171d8311504c723c31896059a071280e2eb27b27509832c1a1b6e5aa0523bd6b329e32f8453d100ed20fcb15b6acbbe394a4c58cfd0efaafb434d338545f9027f503c9fa851a3408f929d38f5bcb6da2110fff3d2cd0c13ec5f974417c4a77e3d645d197360814fdc222a908846eeb814de5e0bdbe0323a0a4906245cc2d3ac629195e479e7c8376d8dd54ea96c56f4ea657aae08ba78252e1ca6b4c6e8dd741f4bbd8b8a703eb5664803f60e613557b986c11d9ee1f8981169d98e949b1e87e9ce5528df8ca1890dbfe6426841992d0fb054bb16",2),I=S(T),P=x("01020408102040801b366cd8ab4d9a2f5ebc63c697356ad4b37dfaefc591",2),A=L(2),z=L(3),O=L(9),B=L(11),E=L(13),R=L(14),D=function(e,r,t){var o,n=p(8),a=d(c(r,t),n),i=a.key,s=a.iv,u=[[83,97,108,116,101,100,95,95].concat(n)];return e=c(e,t),o=h(e,i,s),o=u.concat(o),H.encode(o)},U=function(e,r,t){var o=H.decode(e),n=o.slice(8,16),a=d(c(r,t),n),i=a.key,s=a.iv;return o=o.slice(16,o.length),e=f(o,i,s,t)},Z=function(e){function r(e,r){return e<<r|e>>>32-r}function t(e,r){var t,o,n,a,i;return n=2147483648&e,a=2147483648&r,t=1073741824&e,o=1073741824&r,i=(1073741823&e)+(1073741823&r),t&o?2147483648^i^n^a:t|o?1073741824&i?3221225472^i^n^a:1073741824^i^n^a:i^n^a}function o(e,r,t){return e&r|~e&t}function n(e,r,t){return e&t|r&~t}function a(e,r,t){return e^r^t}function i(e,r,t){return r^(e|~t)}function s(e,n,a,i,s,u,c){return e=t(e,t(t(o(n,a,i),s),c)),t(r(e,u),n)}function u(e,o,a,i,s,u,c){return e=t(e,t(t(n(o,a,i),s),c)),t(r(e,u),o)}function c(e,o,n,i,s,u,c){return e=t(e,t(t(a(o,n,i),s),c)),t(r(e,u),o)}function l(e,o,n,a,s,u,c){return e=t(e,t(t(i(o,n,a),s),c)),t(r(e,u),o)}function p(e){for(var r,t=e.length,o=t+8,n=(o-o%64)/64,a=16*(n+1),i=[],s=0,u=0;t>u;)r=(u-u%4)/4,s=8*(u%4),i[r]=i[r]|e[u]<<s,u++;return r=(u-u%4)/4,s=8*(u%4),i[r]=i[r]|128<<s,i[a-2]=t<<3,i[a-1]=t>>>29,i}function d(e){var r,t,o=[];for(t=0;3>=t;t++)r=255&e>>>8*t,o=o.concat(r);return o}var h,f,m,g,k,v,y,M,_,C=[],b=x("67452301efcdab8998badcfe10325476d76aa478e8c7b756242070dbc1bdceeef57c0faf4787c62aa8304613fd469501698098d88b44f7afffff5bb1895cd7be6b901122fd987193a679438e49b40821f61e2562c040b340265e5a51e9b6c7aad62f105d02441453d8a1e681e7d3fbc821e1cde6c33707d6f4d50d87455a14eda9e3e905fcefa3f8676f02d98d2a4c8afffa39428771f6816d9d6122fde5380ca4beea444bdecfa9f6bb4b60bebfbc70289b7ec6eaa127fad4ef308504881d05d9d4d039e6db99e51fa27cf8c4ac5665f4292244432aff97ab9423a7fc93a039655b59c38f0ccc92ffeff47d85845dd16fa87e4ffe2ce6e0a30143144e0811a1f7537e82bd3af2352ad7d2bbeb86d391",8);for(C=p(e),v=b[0],y=b[1],M=b[2],_=b[3],h=0;C.length>h;h+=16)f=v,m=y,g=M,k=_,v=s(v,y,M,_,C[h+0],7,b[4]),_=s(_,v,y,M,C[h+1],12,b[5]),M=s(M,_,v,y,C[h+2],17,b[6]),y=s(y,M,_,v,C[h+3],22,b[7]),v=s(v,y,M,_,C[h+4],7,b[8]),_=s(_,v,y,M,C[h+5],12,b[9]),M=s(M,_,v,y,C[h+6],17,b[10]),y=s(y,M,_,v,C[h+7],22,b[11]),v=s(v,y,M,_,C[h+8],7,b[12]),_=s(_,v,y,M,C[h+9],12,b[13]),M=s(M,_,v,y,C[h+10],17,b[14]),y=s(y,M,_,v,C[h+11],22,b[15]),v=s(v,y,M,_,C[h+12],7,b[16]),_=s(_,v,y,M,C[h+13],12,b[17]),M=s(M,_,v,y,C[h+14],17,b[18]),y=s(y,M,_,v,C[h+15],22,b[19]),v=u(v,y,M,_,C[h+1],5,b[20]),_=u(_,v,y,M,C[h+6],9,b[21]),M=u(M,_,v,y,C[h+11],14,b[22]),y=u(y,M,_,v,C[h+0],20,b[23]),v=u(v,y,M,_,C[h+5],5,b[24]),_=u(_,v,y,M,C[h+10],9,b[25]),M=u(M,_,v,y,C[h+15],14,b[26]),y=u(y,M,_,v,C[h+4],20,b[27]),v=u(v,y,M,_,C[h+9],5,b[28]),_=u(_,v,y,M,C[h+14],9,b[29]),M=u(M,_,v,y,C[h+3],14,b[30]),y=u(y,M,_,v,C[h+8],20,b[31]),v=u(v,y,M,_,C[h+13],5,b[32]),_=u(_,v,y,M,C[h+2],9,b[33]),M=u(M,_,v,y,C[h+7],14,b[34]),y=u(y,M,_,v,C[h+12],20,b[35]),v=c(v,y,M,_,C[h+5],4,b[36]),_=c(_,v,y,M,C[h+8],11,b[37]),M=c(M,_,v,y,C[h+11],16,b[38]),y=c(y,M,_,v,C[h+14],23,b[39]),v=c(v,y,M,_,C[h+1],4,b[40]),_=c(_,v,y,M,C[h+4],11,b[41]),M=c(M,_,v,y,C[h+7],16,b[42]),y=c(y,M,_,v,C[h+10],23,b[43]),v=c(v,y,M,_,C[h+13],4,b[44]),_=c(_,v,y,M,C[h+0],11,b[45]),M=c(M,_,v,y,C[h+3],16,b[46]),y=c(y,M,_,v,C[h+6],23,b[47]),v=c(v,y,M,_,C[h+9],4,b[48]),_=c(_,v,y,M,C[h+12],11,b[49]),M=c(M,_,v,y,C[h+15],16,b[50]),y=c(y,M,_,v,C[h+2],23,b[51]),v=l(v,y,M,_,C[h+0],6,b[52]),_=l(_,v,y,M,C[h+7],10,b[53]),M=l(M,_,v,y,C[h+14],15,b[54]),y=l(y,M,_,v,C[h+5],21,b[55]),v=l(v,y,M,_,C[h+12],6,b[56]),_=l(_,v,y,M,C[h+3],10,b[57]),M=l(M,_,v,y,C[h+10],15,b[58]),y=l(y,M,_,v,C[h+1],21,b[59]),v=l(v,y,M,_,C[h+8],6,b[60]),_=l(_,v,y,M,C[h+15],10,b[61]),M=l(M,_,v,y,C[h+6],15,b[62]),y=l(y,M,_,v,C[h+13],21,b[63]),v=l(v,y,M,_,C[h+4],6,b[64]),_=l(_,v,y,M,C[h+11],10,b[65]),M=l(M,_,v,y,C[h+2],15,b[66]),y=l(y,M,_,v,C[h+9],21,b[67]),v=t(v,f),y=t(y,m),M=t(M,g),_=t(_,k);return d(v).concat(d(y),d(M),d(_))},H=function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=e.split(""),t=function(e){var t,o,n=[],a="";for(Math.floor(16*e.length/3),t=0;16*e.length>t;t++)n.push(e[Math.floor(t/16)][t%16]);for(t=0;n.length>t;t+=3)a+=r[n[t]>>2],a+=r[(3&n[t])<<4|n[t+1]>>4],a+=void 0!==n[t+1]?r[(15&n[t+1])<<2|n[t+2]>>6]:"=",a+=void 0!==n[t+2]?r[63&n[t+2]]:"=";for(o=a.slice(0,64)+"\n",t=1;Math.ceil(a.length/64)>t;t++)o+=a.slice(64*t,64*t+64)+(Math.ceil(a.length/64)===t+1?"":"\n");return o},o=function(r){r=r.replace(/\n/g,"");var t,o=[],n=[],a=[];for(t=0;r.length>t;t+=4)n[0]=e.indexOf(r.charAt(t)),n[1]=e.indexOf(r.charAt(t+1)),n[2]=e.indexOf(r.charAt(t+2)),n[3]=e.indexOf(r.charAt(t+3)),a[0]=n[0]<<2|n[1]>>4,a[1]=(15&n[1])<<4|n[2]>>2,a[2]=(3&n[2])<<6|n[3],o.push(a[0],a[1],a[2]);return o=o.slice(0,o.length-o.length%16)};return"function"==typeof Array.indexOf&&(e=r),{encode:t,decode:o}}();return{size:l,h2a:u,expandKey:C,encryptBlock:m,decryptBlock:g,Decrypt:t,s2a:c,rawEncrypt:h,rawDecrypt:f,dec:U,openSSLKey:d,a2h:s,enc:D,Hash:{MD5:Z},Base64:H}}),MarkerClusterer.prototype.MARKER_CLUSTER_IMAGE_PATH_="../images/m",MarkerClusterer.prototype.MARKER_CLUSTER_IMAGE_EXTENSION_="png",MarkerClusterer.prototype.extend=function(e,r){return function(e){for(var r in e.prototype)this.prototype[r]=e.prototype[r];return this}.apply(e,[r])},MarkerClusterer.prototype.onAdd=function(){this.setReady_(!0)},MarkerClusterer.prototype.draw=function(){},MarkerClusterer.prototype.setupStyles_=function(){if(!this.styles_.length)for(var e,r=0;e=this.sizes[r];r++)this.styles_.push({url:this.imagePath_+(r+1)+"."+this.imageExtension_,height:e,width:e})},MarkerClusterer.prototype.fitMapToMarkers=function(){for(var e,r=this.getMarkers(),t=new google.maps.LatLngBounds,o=0;e=r[o];o++)t.extend(e.getPosition());this.map_.fitBounds(t)},MarkerClusterer.prototype.setStyles=function(e){this.styles_=e},MarkerClusterer.prototype.getStyles=function(){return this.styles_},MarkerClusterer.prototype.isZoomOnClick=function(){return this.zoomOnClick_},MarkerClusterer.prototype.isAverageCenter=function(){return this.averageCenter_},MarkerClusterer.prototype.getMarkers=function(){return this.markers_},MarkerClusterer.prototype.getTotalMarkers=function(){return this.markers_.length},MarkerClusterer.prototype.setMaxZoom=function(e){this.maxZoom_=e},MarkerClusterer.prototype.getMaxZoom=function(){return this.maxZoom_},MarkerClusterer.prototype.calculator_=function(e,r){for(var t=0,o=e.length,n=o;0!==n;)n=parseInt(n/10,10),t++;return t=Math.min(t,r),{text:o,index:t}},MarkerClusterer.prototype.setCalculator=function(e){this.calculator_=e},MarkerClusterer.prototype.getCalculator=function(){return this.calculator_},MarkerClusterer.prototype.addMarkers=function(e,r){for(var t,o=0;t=e[o];o++)this.pushMarkerTo_(t);r||this.redraw()},MarkerClusterer.prototype.pushMarkerTo_=function(e){if(e.isAdded=!1,e.draggable){var r=this;google.maps.event.addListener(e,"dragend",function(){e.isAdded=!1,r.repaint()})}this.markers_.push(e)},MarkerClusterer.prototype.addMarker=function(e,r){this.pushMarkerTo_(e),r||this.redraw()},MarkerClusterer.prototype.removeMarker_=function(e){var r=-1;if(this.markers_.indexOf)r=this.markers_.indexOf(e);else for(var t,o=0;t=this.markers_[o];o++)if(t==e){r=o;break}return-1==r?!1:(e.setMap(null),e.hasOwnProperty("circle")&&e.circle.setMap(null),this.markers_.splice(r,1),!0)},MarkerClusterer.prototype.removeMarker=function(e,r){var t=this.removeMarker_(e);return!r&&t?(this.resetViewport(),this.redraw(),!0):!1},MarkerClusterer.prototype.removeMarkers=function(e,r){for(var t,o=!1,n=0;t=e[n];n++){var a=this.removeMarker_(t);o=o||a}return!r&&o?(this.resetViewport(),this.redraw(),!0):void 0},MarkerClusterer.prototype.setReady_=function(e){this.ready_||(this.ready_=e,this.createClusters_())},MarkerClusterer.prototype.getTotalClusters=function(){return this.clusters_.length},MarkerClusterer.prototype.getMap=function(){return this.map_},MarkerClusterer.prototype.setMap=function(e){this.map_=e},MarkerClusterer.prototype.getGridSize=function(){return this.gridSize_},MarkerClusterer.prototype.setGridSize=function(e){this.gridSize_=e},MarkerClusterer.prototype.getMinClusterSize=function(){return this.minClusterSize_},MarkerClusterer.prototype.setMinClusterSize=function(e){this.minClusterSize_=e},MarkerClusterer.prototype.getExtendedBounds=function(e){var r=this.getProjection(),t=new google.maps.LatLng(e.getNorthEast().lat(),e.getNorthEast().lng()),o=new google.maps.LatLng(e.getSouthWest().lat(),e.getSouthWest().lng()),n=r.fromLatLngToDivPixel(t);n.x+=this.gridSize_,n.y-=this.gridSize_;var a=r.fromLatLngToDivPixel(o);a.x-=this.gridSize_,a.y+=this.gridSize_;var i=r.fromDivPixelToLatLng(n),s=r.fromDivPixelToLatLng(a);return e.extend(i),e.extend(s),e},MarkerClusterer.prototype.isMarkerInBounds_=function(e,r){return r.contains(e.getPosition())},MarkerClusterer.prototype.clearMarkers=function(){this.resetViewport(!0),this.markers_=[]},MarkerClusterer.prototype.resetViewport=function(e){for(var r,t=0;r=this.clusters_[t];t++)r.remove();for(var o,t=0;o=this.markers_[t];t++)o.isAdded=!1,e&&(o.setMap(null),o.hasOwnProperty("circle")&&o.circle.setMap(null));this.clusters_=[]},MarkerClusterer.prototype.repaint=function(){var e=this.clusters_.slice();this.clusters_.length=0,this.resetViewport(),this.redraw(),window.setTimeout(function(){for(var r,t=0;r=e[t];t++)r.remove()},0)},MarkerClusterer.prototype.redraw=function(){this.createClusters_()},MarkerClusterer.prototype.distanceBetweenPoints_=function(e,r){if(!e||!r)return 0;var t=6371,o=(r.lat()-e.lat())*Math.PI/180,n=(r.lng()-e.lng())*Math.PI/180,a=Math.sin(o/2)*Math.sin(o/2)+Math.cos(e.lat()*Math.PI/180)*Math.cos(r.lat()*Math.PI/180)*Math.sin(n/2)*Math.sin(n/2),i=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),s=t*i;return s},MarkerClusterer.prototype.addToClosestCluster_=function(e){for(var r,t=4e4,o=null,n=(e.getPosition(),0);r=this.clusters_[n];n++){var a=r.getCenter();if(a){var i=this.distanceBetweenPoints_(a,e.getPosition());t>i&&(t=i,o=r)}}if(o&&o.isMarkerInClusterBounds(e))o.addMarker(e);else{var r=new Cluster(this);r.addMarker(e),this.clusters_.push(r)}},MarkerClusterer.prototype.createClusters_=function(){if(this.ready_)for(var e,r=new google.maps.LatLngBounds(this.map_.getBounds().getSouthWest(),this.map_.getBounds().getNorthEast()),t=this.getExtendedBounds(r),o=0;e=this.markers_[o];o++)!e.isAdded&&this.isMarkerInBounds_(e,t)&&this.addToClosestCluster_(e)},Cluster.prototype.isMarkerAlreadyAdded=function(e){if(this.markers_.indexOf)return-1!=this.markers_.indexOf(e);for(var r,t=0;r=this.markers_[t];t++)if(r==e)return!0;return!1},Cluster.prototype.addMarker=function(e){if(this.isMarkerAlreadyAdded(e))return!1;if(this.center_){if(this.averageCenter_){var r=this.markers_.length+1,t=(this.center_.lat()*(r-1)+e.getPosition().lat())/r,o=(this.center_.lng()*(r-1)+e.getPosition().lng())/r;this.center_=new google.maps.LatLng(t,o),this.calculateBounds_()}}else this.center_=e.getPosition(),this.calculateBounds_();e.isAdded=!0,this.markers_.push(e);var n=this.markers_.length;if(n<this.minClusterSize_&&e.getMap()!=this.map_&&(e.setMap(this.map_),e.hasOwnProperty("circle")&&e.circle.setMap(this.map_)),n==this.minClusterSize_)for(var a=0;n>a;a++)this.markers_[a].setMap(null),this.markers_[a].hasOwnProperty("circle")&&this.markers_[a].circle.setMap(null);return n>=this.minClusterSize_&&(e.setMap(null),e.hasOwnProperty("circle")&&e.circle.setMap(null)),this.updateIcon(),!0},Cluster.prototype.getMarkerClusterer=function(){return this.markerClusterer_},Cluster.prototype.getBounds=function(){for(var e,r=new google.maps.LatLngBounds(this.center_,this.center_),t=this.getMarkers(),o=0;e=t[o];o++)r.extend(e.getPosition());return r},Cluster.prototype.remove=function(){this.clusterIcon_.remove(),this.markers_.length=0,delete this.markers_},Cluster.prototype.getSize=function(){return this.markers_.length},Cluster.prototype.getMarkers=function(){return this.markers_},Cluster.prototype.getCenter=function(){return this.center_},Cluster.prototype.calculateBounds_=function(){var e=new google.maps.LatLngBounds(this.center_,this.center_);this.bounds_=this.markerClusterer_.getExtendedBounds(e)},Cluster.prototype.isMarkerInClusterBounds=function(e){return this.bounds_.contains(e.getPosition())},Cluster.prototype.getMap=function(){return this.map_},Cluster.prototype.updateIcon=function(){var e=this.map_.getZoom(),r=this.markerClusterer_.getMaxZoom();if(r&&e>r)for(var t,o=0;t=this.markers_[o];o++)t.setMap(this.map_),t.hasOwnProperty("circle")&&t.circle.setMap(null);else{if(this.markers_.length<this.minClusterSize_)return void this.clusterIcon_.hide();var n=this.markerClusterer_.getStyles().length,a=this.markerClusterer_.getCalculator()(this.markers_,n);this.clusterIcon_.setCenter(this.center_),this.clusterIcon_.setSums(a),this.clusterIcon_.show()}},ClusterIcon.prototype.triggerClusterClick=function(e){var r=this.cluster_.getMarkerClusterer();google.maps.event.trigger(r,"clusterclick",this.cluster_,e),r.isZoomOnClick()&&this.map_.fitBounds(this.cluster_.getBounds())},ClusterIcon.prototype.onAdd=function(){if(this.div_=document.createElement("DIV"),this.visible_){var e=this.getPosFromLatLng_(this.center_);this.div_.style.cssText=this.createCss(e),this.div_.innerHTML=this.sums_.text}var r=this.getPanes();r.overlayMouseTarget.appendChild(this.div_);var t=this,o=!1;google.maps.event.addDomListener(this.div_,"click",function(e){o||t.triggerClusterClick(e)}),google.maps.event.addDomListener(this.div_,"mousedown",function(){o=!1}),google.maps.event.addDomListener(this.div_,"mousemove",function(){o=!0})},ClusterIcon.prototype.getPosFromLatLng_=function(e){var r=this.getProjection().fromLatLngToDivPixel(e);return"object"==typeof this.iconAnchor_&&2===this.iconAnchor_.length?(r.x-=this.iconAnchor_[0],r.y-=this.iconAnchor_[1]):(r.x-=parseInt(this.width_/2,10),r.y-=parseInt(this.height_/2,10)),r},ClusterIcon.prototype.draw=function(){if(this.visible_){var e=this.getPosFromLatLng_(this.center_);this.div_.style.top=e.y+"px",this.div_.style.left=e.x+"px"}},ClusterIcon.prototype.hide=function(){this.div_&&(this.div_.style.display="none"),this.visible_=!1},ClusterIcon.prototype.show=function(){if(this.div_){var e=this.getPosFromLatLng_(this.center_);this.div_.style.cssText=this.createCss(e),this.div_.style.display=""}this.visible_=!0},ClusterIcon.prototype.remove=function(){this.setMap(null)},ClusterIcon.prototype.onRemove=function(){this.div_&&this.div_.parentNode&&(this.hide(),this.div_.parentNode.removeChild(this.div_),this.div_=null)},ClusterIcon.prototype.setSums=function(e){this.sums_=e,this.text_=e.text,this.index_=e.index,this.div_&&(this.div_.innerHTML=e.text),this.useStyle()},ClusterIcon.prototype.useStyle=function(){var e=Math.max(0,this.sums_.index-1);e=Math.min(this.styles_.length-1,e);var r=this.styles_[e];this.url_=r.url,this.height_=r.height,this.width_=r.width,this.textColor_=r.textColor,this.anchor_=r.anchor,this.textSize_=r.textSize,this.backgroundPosition_=r.backgroundPosition,this.iconAnchor_=r.iconAnchor},ClusterIcon.prototype.setCenter=function(e){this.center_=e},ClusterIcon.prototype.createCss=function(e){var r=[];r.push("background-image:url("+this.url_+");");var t=this.backgroundPosition_?this.backgroundPosition_:"0 0";r.push("background-position:"+t+";"),"object"==typeof this.anchor_?("number"==typeof this.anchor_[0]&&this.anchor_[0]>0&&this.anchor_[0]<this.height_?r.push("height:"+(this.height_-this.anchor_[0])+"px; padding-top:"+this.anchor_[0]+"px;"):"number"==typeof this.anchor_[0]&&this.anchor_[0]<0&&-this.anchor_[0]<this.height_?r.push("height:"+this.height_+"px; line-height:"+(this.height_+this.anchor_[0])+"px;"):r.push("height:"+this.height_+"px; line-height:"+this.height_+"px;"),"number"==typeof this.anchor_[1]&&this.anchor_[1]>0&&this.anchor_[1]<this.width_?r.push("width:"+(this.width_-this.anchor_[1])+"px; padding-left:"+this.anchor_[1]+"px;"):r.push("width:"+this.width_+"px; text-align:center;")):r.push("height:"+this.height_+"px; line-height:"+this.height_+"px; width:"+this.width_+"px; text-align:center;");var o=this.textColor_?this.textColor_:"black",n=this.textSize_?this.textSize_:11;return r.push("cursor:pointer; top:"+e.y+"px; left:"+e.x+"px; color:"+o+"; position:absolute; font-size:"+n+"px; font-family:Arial,sans-serif; font-weight:bold"),r.join("")},window.MarkerClusterer=MarkerClusterer,MarkerClusterer.prototype.addMarker=MarkerClusterer.prototype.addMarker,MarkerClusterer.prototype.addMarkers=MarkerClusterer.prototype.addMarkers,
    MarkerClusterer.prototype.clearMarkers=MarkerClusterer.prototype.clearMarkers,MarkerClusterer.prototype.fitMapToMarkers=MarkerClusterer.prototype.fitMapToMarkers,MarkerClusterer.prototype.getCalculator=MarkerClusterer.prototype.getCalculator,MarkerClusterer.prototype.getGridSize=MarkerClusterer.prototype.getGridSize,MarkerClusterer.prototype.getExtendedBounds=MarkerClusterer.prototype.getExtendedBounds,MarkerClusterer.prototype.getMap=MarkerClusterer.prototype.getMap,MarkerClusterer.prototype.getMarkers=MarkerClusterer.prototype.getMarkers,MarkerClusterer.prototype.getMaxZoom=MarkerClusterer.prototype.getMaxZoom,MarkerClusterer.prototype.getStyles=MarkerClusterer.prototype.getStyles,MarkerClusterer.prototype.getTotalClusters=MarkerClusterer.prototype.getTotalClusters,MarkerClusterer.prototype.getTotalMarkers=MarkerClusterer.prototype.getTotalMarkers,MarkerClusterer.prototype.redraw=MarkerClusterer.prototype.redraw,MarkerClusterer.prototype.removeMarker=MarkerClusterer.prototype.removeMarker,MarkerClusterer.prototype.removeMarkers=MarkerClusterer.prototype.removeMarkers,MarkerClusterer.prototype.resetViewport=MarkerClusterer.prototype.resetViewport,MarkerClusterer.prototype.repaint=MarkerClusterer.prototype.repaint,MarkerClusterer.prototype.setCalculator=MarkerClusterer.prototype.setCalculator,MarkerClusterer.prototype.setGridSize=MarkerClusterer.prototype.setGridSize,MarkerClusterer.prototype.setMaxZoom=MarkerClusterer.prototype.setMaxZoom,MarkerClusterer.prototype.onAdd=MarkerClusterer.prototype.onAdd,MarkerClusterer.prototype.draw=MarkerClusterer.prototype.draw,Cluster.prototype.getCenter=Cluster.prototype.getCenter,Cluster.prototype.getSize=Cluster.prototype.getSize,Cluster.prototype.getMarkers=Cluster.prototype.getMarkers,ClusterIcon.prototype.onAdd=ClusterIcon.prototype.onAdd,ClusterIcon.prototype.draw=ClusterIcon.prototype.draw,ClusterIcon.prototype.onRemove=ClusterIcon.prototype.onRemove,$("#menu-toggle").click(function(e){e.preventDefault(),$("#wrapper").toggleClass("toggled")}),$("#menu-toggle-2").click(function(e){e.preventDefault(),$("#wrapper").toggleClass("toggled-2"),$("#menu ul:not(.default-open)").hide()}),$(document).ready(function(){initMenu()}),app.factory("ApiService",["$rootScope",function(e){"use strict";var r=this;return r.token=null,r.marker=function(e,r){$.post("api/marker",e,r)},r.removeMarker=function(){},r.registerNewUser=function(){},r.token=function(){},r.request=function(){},r.auth=function(e,r){$.post("api/auth",e,function(e){"function"==typeof r&&r(e)})},r}]),app.factory("InitService",["$document",function(e){"use strict";function r(){$(document).on("ajaxStart",function(e){}),$(document).on("ajaxComplete",function(e){}),t.fixDateInputs(),t.triggerReady(),t.ready=!0}var t=this,o={ready:[]};return t.ready=!1,t.addEventListener=function(e,r){o[e].push(r),t.ready&&t.bindOnTheFlyReadyEvents()},t.triggerReady=function(){var e;for(e=0;e<o.ready.length;e+=1)o.ready[e](),o.ready.splice(e,1)},t.fixDateInputs=function(){$('input[type="date"], input[type="datetime"], input[type="datetime-local"], input[type="month"], input[type="time"], input[type="week"]').each(function(){var e=this,r=$(e),t=r.attr("type");""==r.val()&&r.attr("type","text"),r.focus(function(){r.attr("type",t),e.click()}),r.blur(function(){""==r.val()&&r.attr("type","text")})})},t.init=function(){!function(){e.ready(function(){-1===document.URL.indexOf("http://")&&-1===document.URL.indexOf("https://")?(console.log("Using Cordova/PhoneGap setting"),document.addEventListener("deviceready",r,!1)):(console.log("Using web browser setting"),r())})}()},t.bindOnTheFlyReadyEvents=function(){e.ready(function(){t.triggerReady()})},t.init(),t}]),app.factory("MapService",["$rootScope","PageService",function(e,r){"use strict";var t=this;return t.bucket="https://s3-us-west-2.amazonaws.com/pgo-static",t.untouched=[],t.canvas=null,t.markers=[],t.map=null,t.content=null,t.options={},t.location={"default":{lat:53.3540406,lng:-6.2589086},object:null},t.defaultMarker={options:{src:t.bucket+"/pokeball.png",size:new google.maps.Size(35,35),scale:new google.maps.Size(35,35)},object:null},t.infoWindow={options:{content:null,maxWidth:400},object:null},t.area={options:{color:"#9acdd7",radius:40}},t.markerClusterer=null,t.defaultLocation=null,t.styles=[{featureType:"road",elementType:"geometry.fill",stylers:[{color:"#525252"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#ccbc08"}]},{featureType:"poi",elementType:"geometry.fill",stylers:[{color:"#11d47c"}]},{featureType:"landscape",elementType:"geometry.fill",stylers:[{color:"#53db6e"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#1157ad"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#2aa363"}]},{featureType:"transit.line",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.local",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit.station",elementType:"all",stylers:[{visibility:"off"}]}],t.geocoder=new google.maps.Geocoder,t.events={},t.events.infoWindowOpened=function(){},t.create=function(r){e.focus?t.defaultLocation=new google.maps.LatLng(e.focus.lat,e.focus.lng):t.defaultLocation=new google.maps.LatLng(t.location["default"].lat,t.location["default"].lng),t.canvas=document.getElementById("map"),t.options={center:t.defaultLocation,zoom:16,panControl:!0,minZoom:7,scrollwheel:!0,mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControlOptions:{mapTypeIds:[]}},t.map=new google.maps.Map(t.canvas,t.options),t.defaultMarker.object=new google.maps.MarkerImage(t.defaultMarker.options.src,t.defaultMarker.options.size,null,null,t.defaultMarker.options.scale)},t.panTo=function(e,r){var o=new google.maps.LatLng(e,r);t.map.panTo(o)},t.setInfoWindowContent=function(e){},t.addListeners=function(){isMobile||(new LongPress(t.map,1e3),google.maps.event.addListener(t.map,"longpress",function(e){t.removeUntouchedMarkers();var o=t.placeMarker(e.latLng);t.untouched.push(o),isMobile||r.showAddSidebar(),t.handleClick(o),t.loadClusterer()}))},t.removeUntouchedMarkers=function(){for(var e in t.untouched){t.markerClusterer.removeMarker(t.untouched[e]);var r=t.markers.indexOf(t.untouched[e]);-1!==r&&t.markers.splice(r,1)}t.map.clearMarkers(t.untouched)},t.marker=function(e){return new google.maps.Marker({position:e,icon:t.defaultMarker.object})},t.pokemonMarker=function(e,r){var o=t.marker(e);return o.setIcon(t.markerImage(r)),o},t.markerImage=function(e){return new google.maps.MarkerImage(e,new google.maps.Size(50,50),null,null,new google.maps.Size(50,50))},t.circle=function(e,r){return"undefined"==typeof e&&(e=t.area.options.color),"undefined"==typeof r&&(r=t.area.options.radius),new google.maps.Circle({map:t.map,radius:r,fillColor:e,strokeColor:e})},t.bindCircleToMarker=function(e,r){e.bindTo("center",r,"position"),r.circle=e},t.addInfoWindowToMarker=function(e){e.addListener("click",function(){t.handleClick(e)})},t.handleClick=function(o){e.currentMarker=o,e.$apply(),isMobile||(o.hasOwnProperty("uuid")?r.showViewSidebar():r.showAddSidebar()),t.inspect(),t.applyPokemonFunction(o)},t.loadClusterer=function(){return t.markerClusterer&&t.markerClusterer.clearMarkers(),t.markerClusterer=new MarkerClusterer(t.map,t.markers,{zoom:13,center:t.defaultLocation,imagePath:t.bucket+"/maps/m",zoomOnClick:!0,minimumClusterSize:50}),e.clusterer=t.markerClusterer,t.markerClusterer},t.placeMarker=function(e,o){var n,a=t.area.options.color;if("undefined"!=typeof o){if(n=$('[data-number="'+o.number+'"]')){var i=t.pokemonMarker(e,n.attr("src"));i.uuid=o.uuid,i.model=o,a=(new ColorThief).getColor(n[0]),a=rgbToHex(a[0],a[1],a[2])}}else var i=t.marker(e);if(!i.hasOwnProperty("circle")){var s=t.circle(a);t.bindCircleToMarker(s,i),isMobile||(new LongPress(s,1e3),google.maps.event.addListener(s,"longpress",function(e){t.removeUntouchedMarkers();var o=t.placeMarker(e.latLng);t.untouched.push(o),isMobile||r.showAddSidebar(),t.handleClick(o),t.loadClusterer()}))}return t.addInfoWindowToMarker(i),t.markers.push(i),i},t.removeFromClusterer=function(e){var r;return(r=-1!==t.markerClusterer.markers_.indexOf(e))&&t.markerClusterer.markers_.splice(r,1),t.markerClusterer.markers_},t.removeMarker=function(o){o.setMap(null),o.hasOwnProperty("circle")&&o.circle.setMap(null),e.currentMarker=null,e.$apply(),t.markerClusterer.removeMarker(o);var n=t.markers.indexOf(o);-1!==n&&t.markers.splice(n,1),isMobile||r.showMainSidebar()},t.applyPokemonFunction=function(){$(".search-box").off("keyup"),$(".search-box").on("keyup",function(){return""==$(this).val()?$(".pokemon-list img.pokemon").show():($(".pokemon-list img.pokemon").hide(),void $('.pokemon-list img.pokemon[data-query*="'+$(this).val().toLowerCase()+'"]').show())}),$(".remove-marker").off("click"),$(".remove-marker").on("click",function(){t.removeMarker(e.currentMarker)})},t.clearAllMarkers=function(){t.map.clearMarkers(t.markers),t.markers=[]},t.init=function(e){t.create(e.map),t.setInfoWindowContent(e.content),t.addListeners(),google.maps.event.addListenerOnce(t.map,"idle",function(){$("#pac-input").show(),$(".loading").hide()}),e.callback&&"function"==typeof e.callback&&e.callback()},t.inspect=function(){if(e.reported=!1,e.owner=!1,e.seen=!1,e.reported_label="Report this marker",e.seen_label="I saw this pokemon around here!",e.currentMarker){var r=e.currentMarker.uuid;if(!r)return!1;if(!(r in e.userData))return!1;var t=e.userData[r];e.reported=t.report,e.seen=t.seen,e.owner=t.owner,t.report&&(e.reported_label="Thanks for reporting!"),t.seen&&(e.seen_label="Thanks for marking this as seen!"),e.$$phase||e.$apply()}},t}]),app.factory("PageService",["$rootScope","$timeout",function(e,r){"use strict";var t=this;return t.hideSidebar=function(){$(".sidebar").addClass("off")},t.hideAll=function(){t.hideMyLocationsScreen(),t.hideSplashScreen(),t.hideSidebar()},t.hideAllRight=function(){t.hideFilters(),t.hideMyMarkersBox()},t.hideSplashScreen=function(){$(".splash-screen").addClass("off"),$(".chitikaAdContainer").remove()},t.showSplashScreen=function(){t.hideAll(),$(".splash-screen").removeClass("off")},t.hideMyLocationsScreen=function(){$(".save-my-location-screen").addClass("off")},t.showMyLocationScreen=function(){t.hideAll(),$(".save-my-location-screen").removeClass("off"),$('[name="mylocation"]').focus()},t.showMainSidebar=function(){t.hideSidebar(),$(".main-sidebar").removeClass("off")},t.showAddSidebar=function(){t.hideAll(),$(".add-pokemon-sidebar").removeClass("off")},t.showViewSidebar=function(){t.hideAll(),$(".view-pokemon-sidebar").removeClass("off")},t.showFilters=function(){t.hideAllRight(),$(".filters").removeClass("off-right"),r(function(){$(".filters").show()},400)},t.hideFilters=function(){$(".filters").addClass("off-right"),r(function(){$(".filters").hide()},400)},t.showMyMarkersBox=function(){t.hideAllRight(),$(".my-markers-box").removeClass("off-right"),r(function(){$(".my-markers-box").show()},400)},t.hideMyMarkersBox=function(){$(".my-markers-box").addClass("off-right"),r(function(){$(".my-markers-box").hide()},400)},t}]),app.controller("MapController",["$rootScope","$scope","$http","$timeout","InitService","MapService","ApiService","PageService",function(e,r,t,o,n,a,i,s){"use strict";var u=this,c="gyuHBJKAYO7UIHJNKS89UYHJASNM2#";r.events={},r.loading=!0,r.sidebar=!1,r.pokemons=[],r.latest=[],r.center_loader=!0,r.loading_icon=a.bucket+"/loading.gif",e.reported=!1,e.owner=!1,e.seen=!1,e.reported_label="Report this marker",e.seen_label="I saw this pokemon around here!",r.locations=[],r.myMarkersActive=!1,r.myMarkers=[],u.filteredPokemon=[],r.filteredMarkers=[],r.mylocation_name=null,u.markersByNumber={},u.markers=[],u.remainingMarkers=[],e.$watch("currentMarker",function(){a.inspect()}),r.events.showSplashScreen=function(){s.showSplashScreen()},r.events.myMarkersClick=function(e){a.clearAllMarkers(),r.myMarkersActive?(s.showFilters(),r.myMarkersActive=!1,$(".my-locations-link").removeClass("selected"),u.remainingMarkers=u.getMarkers(),u.loadMarkers()):(s.showMyMarkersBox(),r.myMarkersActive=!0,$(".my-locations-link").addClass("selected"),u.loadMyMarkers())},r.events.pokemonFilterClick=function(e){var r=$(e.currentTarget),t=r.data("number"),o=u.filteredPokemon.indexOf(t);-1!==o?(u.filteredPokemon.splice(o,1),r.removeClass("selected")):(u.filteredPokemon.push(t),r.addClass("selected")),a.clearAllMarkers(),u.loadFilteredMarkers()},r.$watch("pokemon_filter",function(e){return e?($(".pokemon-filters .pokemon").hide(),void $('.pokemon-filters .pokemon[data-query*="'+e.toLowerCase()+'"]').show()):$(".pokemon-filters .pokemon").show()}),r.events.googleLoginClick=function(){$(".abcRioButton").click()},r.events.viewMarkerClickHere=function(){s.showAddSidebar()},r.events.googleLogin=function(r){var t=r.getBasicProfile(),o=r.getAuthResponse().id_token;if(!e.token){var n={name:t.getName(),id:t.getId(),email:t.getEmail(),network:"google",accessToken:o};i.auth(n,function(r){e.currentMarker.hasOwnProperty("uuid")&&(s.hideAll(),s.showViewSidebar()),e.token=r.token,e.$apply()})}},r.events.login=function(){FB.login(function(r){if(r.authResponse){var t=r.authResponse.accessToken;FB.api("/me",{locale:"en_US",fields:"name, email"},function(r){r.email&&(r.accessToken=t,r.network="facebook",i.auth(r,function(r){e.currentMarker.hasOwnProperty("uuid")&&(s.hideAll(),s.showViewSidebar()),e.token=r.token,e.$apply()}))})}else console.log("User cancelled login or did not fully authorize.")},{scope:"email"})},r.events.finishAddingPokemon=function(e){s.showViewSidebar(),a.inspect()},r.events.goToLocation=function(e,r){a.panTo(e,r),a.map.setZoom(16)},r.events.goToLocationHash=function(e){if(e.uuid in u.cached)var r=u.cached[e.uuid];else{var r=u.decode(e.location,e.uuid);u.cached[e.uuid]=r}a.panTo(r.lat,r.lng),a.map.setZoom(16)},r.events.closeAddSidebar=function(e){s.showMainSidebar()},r.events.closeMainSidebar=function(e){s.hideSidebar()},r.events.openMyLocationScreen=function(e){s.showMyLocationScreen()},r.events.closeMyLocationsScreen=function(e){s.hideMyLocationsScreen()},r.events.closeSplashScreen=function(e){s.hideSplashScreen()},r.events.latest=function(e){var r=u.decode(e.location,e.uuid);a.panTo(r.lat,r.lng),a.map.setZoom(16),u.loadMarkers()},r.events.report=function(){e.currentMarker.uuid&&$.post("api/report",{uuid:e.currentMarker.uuid,token:e.token},function(r){return r.hasOwnProperty("error")?void console.error(r.error):(e.userData[e.currentMarker.uuid]?e.userData[e.currentMarker.uuid].report=!0:e.userData[e.currentMarker.uuid]={report:!0,owner:!1,seen:!1},e.currentMarker.model.reports+=1,e.$apply(),void a.inspect())})},r.events.location=function(){var t=a.map.getCenter();$.post("api/location",{lat:t.lat(),lng:t.lng(),name:r.mylocation_name,token:e.token},function(e){return e.hasOwnProperty("error")?void console.error(e.error):(r.locations.push(e),r.$apply(),void s.hideMyLocationsScreen())})},r.events.removeLocation=function(e){$.post("api/remove-location",{uuid:e.uuid,token:r.token},function(t){if(t.hasOwnProperty("error"))return void console.error(t.error);var o=r.locations.indexOf(e);r.locations.splice(o,1),r.$apply()})},r.events.sight=function(){e.currentMarker.uuid&&$.post("api/sight",{uuid:e.currentMarker.uuid,token:e.token},function(r){return r.hasOwnProperty("error")?void console.error(r.error):(e.userData[e.currentMarker.uuid]?e.userData[e.currentMarker.uuid].seen=!0:e.userData[e.currentMarker.uuid]={report:!1,owner:!1,seen:!0},e.currentMarker.model.sights+=1,e.$apply(),void a.inspect())})},r.events.remove=function(){e.currentMarker.uuid?$.post("api/remove",{uuid:e.currentMarker.uuid,token:e.token},function(t){if(t.hasOwnProperty("error"))return void console.error(t.error);var o=angular.element($("[ng-controller]")).scope().currentMarker.model;a.removeMarker(e.currentMarker);var n=r.myMarkers.indexOf(o);-1!==n&&r.myMarkers.splice(n,1);var n=u.remainingMarkers.indexOf(o);-1!==n&&u.remainingMarkers.splice(n,1);var n=u.markers.indexOf(o);-1!==n&&u.markers.splice(n,1),r.$apply()}):a.removeMarker(e.currentMarker)},r.events.select=function(t){var o=$(t.currentTarget),n=o.data("number"),s=$('[data-number="'+n+'"]').attr("src"),c=a.markerImage(s);e.currentMarker.setIcon(c);var l=(new ColorThief).getColor($('[data-number="'+n+'"]')[0]);l=rgbToHex(l[0],l[1],l[2]),e.currentMarker.circle.set("fillColor",l),e.currentMarker.circle.set("strokeColor",l);var p=null;e.currentMarker.hasOwnProperty("uuid")&&(p=e.currentMarker.uuid),i.marker({lat:e.currentMarker.position.lat(),lng:e.currentMarker.position.lng(),number:o.data("number"),uuid:p,token:e.token},function(t){if(t.hasOwnProperty("error"))return void console.error(t.error);e.currentMarker.uuid=t.uuid,e.currentMarker.model=t,e.$apply(),e.userData[t.uuid]={report:!1,owner:!0,seen:!0};for(var o in r.myMarkers){var n=r.myMarkers[o];if(n.uuid==t.uuid){r.myMarkers.splice(o,1);break}}r.myMarkers.push(t),r.$apply(),u.markers.push(t),a.untouched=[]})},u.init=function(){u.loadPokemon(function(){a.init({map:document.getElementById("map"),content:$(".pokemon-list-template").html(),callback:u.callback})})},u.cached=[],u.filtered=!1,u.loadMyMarkers=function(){r.center_loader=!0,r.$$phase||r.$apply(),o(function(){for(var e in r.myMarkers){var t=r.myMarkers[e];if(t.uuid in u.cached)var o=u.cached[t.uuid];else{var o=u.decode(t.location,t.uuid);u.cached[t.uuid]=o}a.placeMarker(o,t)}a.loadClusterer(),r.center_loader=!1,r.$$phase||r.$apply()},200)},u.loadFilteredMarkers=function(){u.filteredPokemon.length>0?(u.filtered=!0,r.center_loader=!0,r.$$phase||r.$apply(),o(function(){r.filteredMarkers=[];for(var e in u.filteredPokemon){var t=u.filteredPokemon[e];r.filteredMarkers=r.filteredMarkers.concat(u.markersByNumber[t])}for(var e in r.filteredMarkers){var o=r.filteredMarkers[e];if(o.uuid in u.cached)var n=u.cached[o.uuid];else{var n=u.decode(o.location,o.uuid);u.cached[o.uuid]=n}a.placeMarker(n,o)}a.loadClusterer(),r.center_loader=!1,r.$$phase||r.$apply()},200)):(u.filtered=!1,r.filteredMarkers=[],u.remainingMarkers=u.getMarkers(),u.loadMarkers())},u.getMarkers=function(){return u.markers.slice()},u.decode=function(e,r){return JSON.parse(Hasher.dec(e,r+c))},u.loadMarkers=function(){u.filtered||r.myMarkersActive||(r.center_loader=!0,r.$$phase||r.$apply(),o(function(){var e=!1,t=[];for(var o in u.remainingMarkers){var n=u.remainingMarkers[o];if(!n.map){if(n.uuid in u.cached)var i=u.cached[n.uuid];else{var i=u.decode(n.location,n.uuid);u.cached[n.uuid]=i}var s=new google.maps.LatLng(i.lat,i.lng);a.map.getBounds().contains(s)&&(e=!0,a.placeMarker(i,n),t.push(o))}}for(var o=t.length-1;o>=0;o--)u.remainingMarkers.splice(t[o],1);e&&a.loadClusterer(),r.center_loader=!1,r.$$phase||r.$apply()},200))},u.callback=function(){t({method:"GET",url:"api/markers",params:{token:r.token}}).success(function(t){r.totalMarkers=t.markers.length,e.userData=t.data,u.remainingMarkers=t.markers,u.markers=t.markers.slice();for(var n in u.markers){var i=u.markers[n];u.markersByNumber.hasOwnProperty(i.number)||(u.markersByNumber[i.number]=new Array),u.markersByNumber[i.number].push(i),e.userData.hasOwnProperty(i.uuid)&&1==e.userData[i.uuid].owner&&r.myMarkers.push(i)}o(function(){u.loadMarkers(),r.loading=!1},2e3),google.maps.event.addListener(a.map,"zoom_changed",function(){u.loadMarkers()}),google.maps.event.addListener(a.map,"dragend",function(){u.loadMarkers()});var c=document.getElementById("pac-input"),l=new google.maps.places.SearchBox(c);a.map.controls[google.maps.ControlPosition.TOP_RIGHT].push(c),a.map.addListener("bounds_changed",function(){l.setBounds(a.map.getBounds())}),l.addListener("places_changed",function(){try{var e=l.getPlaces();if(0==e.length)return;var r=e[0];if(!r.geometry)throw new Error("api call limit");a.map.panTo(r.geometry.location),a.map.setZoom(16),u.loadMarkers()}catch(t){alert("It seems that we've reached the limit of Google Places API calls. We've already asked Google to increase our API limit, please, try again later. Thanks for your patience.")}}),s.showMainSidebar()})},u.loadPokemon=function(o){t.get("api/start").success(function(t){e.focus=t.focus,r.pokemons=t.pokemons,r.latest=t.latest,r.locations=t.locations,e.token=t.token,"function"==typeof o&&o()})},n.addEventListener("ready",function(){google.maps.event.addDomListener(window,"load",u.init),$(".nav-search-box").off("keyup"),$(".nav-search-box").on("keyup",function(){return""==$(this).val()?$(".pokemon-nav-list .pokemon").show():($(".pokemon-nav-list .pokemon").hide(),void $('.pokemon-nav-list .pokemon[data-query*="'+$(this).val().toLowerCase()+'"]').show())})})}]),window.onbeforeunload=function(e){gapi.auth2.getAuthInstance().signOut()};